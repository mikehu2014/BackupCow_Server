unit kg_dnc;

interface

uses SysUtils, FGInt, FGIntRSA;

function KeyDec(ss: string): string;

const
  nn: string = 'A3DA3D2003116B4F37675370DCD23B4C61E0D4BFD15278AA5D34C'
    + '4D666B146DB88E538973827820A1525679907701EB2F77BFBE4BA597D34E9F'
    + '74A24A01A9D414CF37D792544D1F4780C7D2E6A1449759525C9746759802C2'
    + '6CD56A669D5C3FE298152D746FA52C341D7844F197B4B8A4F0753278F3796E1'
    + '2009C33B4D5A0D763DB2F0AEC52E0B79D59D013776E96662E45B62ABF18AD20'
    + '62F33582413A1D18ED61F138522AD175D2427460C5F226CACEC48636B77A4A9'
    + '28256CDEE8DA4F39E588AB272C2F2B65806A635D7E131AF3335E10D1D9F68D4'
    + '1F1570EC52DA52DECD3EA9E721CCC72460A9B2F92CC0A29C3DA7C20F833C72DE'
    + 'B7E6861C2F275816B3770BB46ECE99DD127A79210FD3';
  ee: string = '1A7E4AEE196E174E7E1BCF6B021A11206B121C5877367EBD6B0B998'
    + 'EEAB5FBFB742D682AEBA8042953BC8435230C21A2B8C3F19427921B47A3961DA'
    + '042F1205896ACE2023213F5805982E4AC660F5A37E4F445C790BC6CF4C9D9824'
    + '15BCCE30EBD568D27B42D1D815CBE5BBEC5362D42357EFB2A3987B0566338751'
    + '5FAB034752897AD3B1B98C94A8CAB709538100673C155D69457AB109E733B842'
    + '29876FB73EDFA126BD1B90EEEC23E2195F96D1F37137E70CB1F420D69CCEE239'
    + 'C98ED4BAC0745478C29E44434C5DA2C664A93536A27F99D292638BA5C4CAD086'
    + '0B70D41BE8B4C1E24D1ECCD8283233AF97BF59525C8816BB7C10EDFD28086ABC'
    + '54672F99C33D336DBF83C0C77B75D4C8A1';

implementation

function KeyDec(ss: string): string;
var
  KeyStr, s: string;
  n, e: TFGInt;
begin
  try
    KeyStr := Trim(ss);
    KeyStr := stringreplace(KeyStr, #13#10, '', [rfreplaceall]);
    KeyStr := stringreplace(KeyStr, ' ', '', [rfreplaceall]);
    Base16StringToFGInt(nn, n);
    Base16StringToFGInt(ee, e);
    RSADecryptEx(KeyStr, e, n, s);
  except
  end;
  result := s;
end;

end.
 